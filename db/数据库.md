# orcal

## 基本操作

```sql
//修改数据
select r.*,rowid from tmp_invm r;
//删除表
drop table table_name;

1、su – oracle 不是必需，适合于没有DBA密码时使用，可以不用密码来进入sqlplus界面。
2、sqlplus /nolog 或sqlplus system/manager 或./sqlplus ;
3、SQL>connect / as sysdba ;（as sysoper）或
connect internal/oracle AS SYSDBA ;(scott/tiger)
conn sys/change_on_install as sysdba;
4、SQL>startup; 启动数据库实例
5、 查看当前的所有数据库: select * from v$database;
select name from v$database;
desc v$databases; 查看数据库结构字段
7、怎样查看哪些用户拥有SYSDBA、SYSOPER权限:
SQL>select * from V_$PWFILE_USERS;
Show user;查看当前数据库连接用户
8、进入test数据库：database test;
9、查看所有的数据库实例：select * from v$instance;
如：ora9i
10、查看当前库的所有数据表：
SQL> select TABLE_NAME from all_tables;
select * from all_tables;
SQL> select table_name from all_tables where table_name like ‘u’;
TABLE_NAME———————————————default_auditing_options
11、查看表结构：desc all_tables;
12、显示CQI.T_BBS_XUSER的所有字段结构：
desc CQI.T_BBS_XUSER;
13、获得CQI.T_BBS_XUSER表中的记录：
select * from CQI.T_BBS_XUSER;
14、增加数据库用户：(test11/test)
create user test11 identified by test default tablespace users Temporary TABLESPACE Temp;
15、用户授权:
grant connect,resource,dba to test11;
grant sysdba to test11;
commit;
16、更改数据库用户的密码：(将sys与system的密码改为test.)
alter user sys indentified by test;
alter user system indentified by test;
```
## ogg问题
```sql
2019-06-24 10:34:00  ERROR   OGG-00446  Redo sequence 51868 no longer available in online logs for thread 1 without archiving enabled, SQL <SELECT MAX(sequence#)  FROM v$log WHERE thread# = :ora_thread>, error retrieving redo file name for sequence 51868, archived = 0, use_alternate = 0Not able to establish initial position for sequence 51868, rba 48308752.

查看最新日志序列号select * from v$Log;
alter extract E247,extseqno 51941,extrba 0
```
## 建表操作
```sql
-- 分区表创建
create table dbName.tableName(
    id varchar2(64),
    acct_no varchar2(32),
    post_date date
)
partition by range(post_date)(
    partition part_20230329 values less than (to_date('2023-03-30 00:00:00','SYYY-MM-DD HH24:MI:SS','nls_calendar=gregorian'))
    
    -- 以下可以不需要
    tablespace USERS --表空间
    pctfree 10  --为一个数据块保留的空间百分比，表示当数据块的可用空间地狱10%后，就不能被insert，只能被用于update
    initrans 2 --指的是一个BLOCK上初始预分区给并行交易控制的空间(ITLs)
    maxtrans 255 --指initrans空间不够，扩充到maxtrans大小
    storage
    (
        initial 80k
        next 1M
        minextents 1
        maxextents unlimited
    )
    --

    -- 最大分区
    partition part_maxvalue values less than (maxvalue)
);

--创建唯一索引
create unique index index_id on dbName.tableName (id,acct_no); 

--添加最大分区
alter table dbName.tableName add partition part_maxvalue values less than (maxvalue);

--删除分区
alter table dbName.tableName drop partition part_maxvalue;

--添加分区
alter table dbName.tableName add partition part_20230401 values less than (to_date('2023-03-30 00:00:00','SYYY-MM-DD HH24:MI:SS','nls_calendar=gregorian')) tablespace USERS;

--拆分最大分区
alter table dbName.tableName split partition part_maxvalue at(to_date('2023-04-12 00:00:00','SYYY-MM-DD HH24:MI:SS','nls_calendar=gregorian')) into (partition part_20230411,partition part_maxvalue);

--添加字段备注
comment on table dbName.tableName.columnName is 'columnsName的备注' 
```
## varchar和varchar2区别
1. varchar是标准sql里面的。varchar2是oracle提供的独有的数据类型。
2. varchar对于汉字占两个字节，对于英文是一个字节，占的内存小，varchar2都是占用两个字节。
3. varchar对空串不处理，varchar2将空串当做null来处理。
4. varchar存放固定长度的字符串，最大长度为2000，varchar2存放可变长度的字符串，最大长度为4000；


# GAUSS
## 建表语句
```sql
-- 建表
create table dbName.tableName(
    id varchar2(64),
    acct_no varchar2(32),
    post_date date
)
DISTRIBUTE BY HASH(id)  --分布键使得数据分布均匀
PARTITION BY RANGE(post_date)(
    PARTITION part_20220329 values less than(to_date('2022-03-29 00:00:00')),
    PARTITION part_maxvalue values less than (MAXVALUE)
);

--添加注释
comment on table dbName.tableName.columnName is 'columnsName的备注' 

```